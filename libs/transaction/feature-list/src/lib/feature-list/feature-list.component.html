<ngbank-page>
  <h1>Transactions</h1>

  <ngbank-select-account
    [accounts]="accounts$ | async"
    (selectionChange)="selectAccount($event)"
  ></ngbank-select-account>

  <ngbank-new-transaction
    [selectedAccountId]="selectedAccountId$ | async"
    (createTransaction)="createTransaction($event)"
  ></ngbank-new-transaction>

  @if (
    transactionsGroupedByBookingDate$ | async;
    as transactionsGroupedByBookingDate
  ) {
    <mat-list>
      @for (group of transactionsGroupedByBookingDate; track group) {
        <div mat-subheader>
          {{ group.bookingDate | date }}
        </div>
        @for (transaction of group.transactions; track transaction) {
          <mat-list-item>
            <span matListItemTitle>
              {{
                transaction.counterPartyName
                  ? transaction.counterPartyName
                  : '-'
              }}
            </span>
            <span matListItemLine>
              {{ transaction.e2eReference ? transaction.e2eReference : '-' }}
            </span>
            <span
              matListItemMeta
              [ngClass]="{ 'text-success': transaction.amount > 0 }"
              >{{
                transaction.amount | currency: transaction.currencyCode
              }}</span
            >
          </mat-list-item>
        }
      }
    </mat-list>
  } @else {
    <p>You don't have any transactions yet</p>
  }
</ngbank-page>
